<!doctype html>
<html>
    <head>
        <title>Elevator Saga - the elevator programming game</title>
        <meta charset="UTF-8" />
        <link rel="stylesheet" href="./src/style.css" media="all" />
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>
                    Elevator Saga
                    <em class="emphasis-color"
                        >The elevator programming game</em
                    >
                </h1>
            </div>

            <div class="challenge">
                <h3>
                    Challenge: <span class="emphasis-color">Loading...</span>
                </h3>
            </div>

            <div class="world">
                <div class="feedbackcontainer"></div>
                <div class="innerworld"></div>
                <div class="statscontainer">
                    <!-- Stats will be populated by web component -->
                </div>
            </div>

            <div class="codestatus"></div>
            <div class="code">
                <div id="code"></div>
            </div>
            <div class="controls">
                <div>
                    <button id="button_reset">Reset</button>
                    <button id="button_resetundo">Undo reset</button>
                </div>
                <div>
                    <span id="save_message"></span>
                </div>
            </div>
            <div class="footer">
                <h4>
                    <a href="https://github.com/dannycoates/saga"
                        >Source code</a
                    >
                    on GitHub
                </h4>
            </div>
        </div>

        <script type="text/plain" id="default-elev-implementation">
            /**
              * @class Floor
              *   Accessors:
              *    @member buttons {{up: boolean, down: boolean}}
              *    @member level {number}
              *
              * @class Elevator
              *   Accessors:
              *    @member currentFloor {number}
              *    @member destinationFloor {number | null}
              *    @member pressedFloorButtons {number[]}
              *    @member percentFull {0..1}
              *
              *   Actions:
              *    @func goToFloor(floorNum: number)
              */

              let nextFloor = 1

              /**
              * Update gets called on a regular, fast interval (a game loop)
              * @param {Elevator[]} elevators
              * @param {Floor[]} floors
              */
              export function update(elevators, floors) {
                const elevator = elevators[0]

                if (elevator.destinationFloor === null) {
                  if (nextFloor === floors.length) {
                    nextFloor = 0
                  }
                  nextFloor = nextFloor + 1
                  elevator.goToFloor(nextFloor)
                }
              }
        </script>

        <script type="text/plain" id="devtest-elev-implementation">
            export function update(dt, elevators, floors) {
                // Dev test update
                console.log("Running dev test implementation", dt);
            }
        </script>

        <!-- Main application entry point -->
        <script type="module" src="./src/app.js"></script>
    </body>
</html>
